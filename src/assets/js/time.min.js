!function(e){e.fn.thooClock=function(o){this.each(function(){var a,r,t,n,i,s;function l(e){return Math.PI/180*e}function d(e){return e>=12&&(e-=12),e}function m(e){r.beginPath(),r.moveTo(0,0),r.lineTo(0,-1*e),r.stroke()}function u(e,o,a){var n,i,s,m=t.size/2.4;r.save(),r.lineWidth=parseInt(t.size/30,10),r.lineCap="butt",r.strokeStyle=o,void 0!==(n=e)&&(i=d(n.getHours()),s=n.getMinutes()),e=parseInt(i,10)+s/60,r.rotate(l(30*e)),r.shadowColor="rgba(0,0,0,.5)",r.shadowBlur=parseInt(t.size/55,10),r.shadowOffsetX=parseInt(t.size/300,10),r.shadowOffsetY=parseInt(t.size/300,10),r.beginPath(),r.moveTo(0,0),r.lineTo(0,-1*(m-t.size/10)),r.stroke(),r.beginPath(),r.strokeStyle=a,r.moveTo(0,-1*(m-t.size/10)),r.lineTo(0,-1*m),r.stroke(),r.beginPath(),r.arc(0,0,parseInt(t.size/24,10),0,360,!1),r.fillStyle=o,r.fill(),r.restore()}function f(o,a){var n,i,h,c,p,C,T,z,v,g,I,w,b,H,x,k,S;i=(n=new Date).getSeconds(),h=(p=n.getMinutes())+i/60,C=d((c=n.getHours())+("+0"!==(z=t.hourCorrection)&&""!==z?"+"===z.charAt(0)?+z.substring(1):-z.substring(1):0))+h/60,r.clearRect(-s,-s,t.size,t.size),function(e,o){var a,n,i,l,d,m,u,f,h,c,p,C,T,z,v,g,I;for(a=parseInt(s-t.size/50,10),n=s-t.size/400,r.beginPath(),r.arc(0,0,n,0,360,!1),r.fillStyle=o,r.fill(),i=1;i<=60;i+=1)l=Math.PI/30*i,d=Math.sin(l),m=Math.cos(l),i%5==0?(r.lineWidth=parseInt(t.size/50,10),u=d*(a-a/9),f=m*-(a-a/9),h=d*a,c=m*-a,p=d*(a-a/4.2),C=m*-(a-a/4.2),T=i/5,r.textBaseline="middle",z=parseInt(t.size/13,10),r.font="100 "+z+"px helvetica",v=r.measureText(T).width,r.beginPath(),r.fillStyle=e,t.showNumerals&&r.fillText(T,p-v/2,C)):(r.lineWidth=parseInt(t.size/100,10),u=d*(a-a/20),f=m*-(a-a/20),h=d*a,c=m*-a),r.beginPath(),r.strokeStyle=e,r.lineCap="round",r.moveTo(u,f),r.lineTo(h,c),r.stroke();void 0!==t.brandText&&(r.font="100 "+parseInt(t.size/28,10)+"px helvetica",g=r.measureText(t.brandText).width,r.fillText(t.brandText,-g/2,t.size/6)),void 0!==t.brandText2&&(r.textBaseline="middle",r.font="100 "+parseInt(t.size/44,10)+"px helvetica",I=r.measureText(t.brandText2).width,r.fillText(t.brandText2,-I/2,t.size/5))}(t.dialColor,t.dialBackgroundColor),void 0!==t.alarmTime&&u(t.alarmTime,t.alarmHandColor,t.alarmHandTipColor),v=C,g=t.hourHandColor,I=t.size/3,r.save(),r.lineWidth=parseInt(t.size/25,10),r.lineCap="round",r.strokeStyle=g,r.rotate(l(30*v)),r.shadowColor="rgba(0,0,0,.5)",r.shadowBlur=parseInt(t.size/50,10),r.shadowOffsetX=parseInt(t.size/300,10),r.shadowOffsetY=parseInt(t.size/300,10),m(I),r.restore(),w=h,b=t.minuteHandColor,H=t.size/2.2,r.save(),r.lineWidth=parseInt(t.size/50,10),r.lineCap="round",r.strokeStyle=b,r.rotate(l(6*w)),r.shadowColor="rgba(0,0,0,.5)",r.shadowBlur=parseInt(t.size/50,10),r.shadowOffsetX=parseInt(t.size/250,10),r.shadowOffsetY=parseInt(t.size/250,10),m(H),r.restore(),x=i,k=t.secondHandColor,S=s-t.size/40,r.save(),r.lineWidth=parseInt(t.size/150,10),r.lineCap="round",r.strokeStyle=k,r.rotate(l(6*x)),r.shadowColor="rgba(0,0,0,.5)",r.shadowBlur=parseInt(t.size/80,10),r.shadowOffsetX=parseInt(t.size/200,10),r.shadowOffsetY=parseInt(t.size/200,10),m(S),r.beginPath(),r.moveTo(0,0),r.lineTo(0,S/15),r.lineWidth=parseInt(t.size/30,10),r.stroke(),r.beginPath(),r.arc(0,0,parseInt(t.size/30,10),0,360,!1),r.fillStyle=k,r.fill(),r.restore(),1===(a+=1)&&(e(t).trigger("onEverySecond"),a=0),void 0!==t.alarmTime&&(T=60*t.alarmTime.getHours()*60+60*t.alarmTime.getMinutes()+t.alarmTime.getSeconds()),60*c*60+60*p+i>=T&&(o+=1),o<=t.alarmCount&&0!==o&&e(t).trigger("onAlarm");var y=1e3-(new Date).getTime()%1e3;setTimeout(function(){f(o,a)},y)}n={size:250,dialColor:"#000000",dialBackgroundColor:"transparent",secondHandColor:"#F3A829",minuteHandColor:"#222222",hourHandColor:"#222222",alarmHandColor:"#FFFFFF",alarmHandTipColor:"#026729",hourCorrection:"+0",alarmCount:1,showNumerals:!0},i=e.extend({},n,o),(t=this).size=i.size,t.dialColor=i.dialColor,t.dialBackgroundColor=i.dialBackgroundColor,t.secondHandColor=i.secondHandColor,t.minuteHandColor=i.minuteHandColor,t.hourHandColor=i.hourHandColor,t.alarmHandColor=i.alarmHandColor,t.alarmHandTipColor=i.alarmHandTipColor,t.hourCorrection=i.hourCorrection,t.showNumerals=i.showNumerals,t.brandText=i.brandText,t.brandText2=i.brandText2,t.alarmCount=i.alarmCount,t.alarmTime=i.alarmTime,t.onAlarm=i.onAlarm,t.offAlarm=i.offAlarm,t.onEverySecond=i.onEverySecond,a=document.createElement("canvas"),r=a.getContext("2d"),a.width=this.size,a.height=this.size,e(a).appendTo(t),s=parseInt(t.size/2,10),r.translate(s,s),e.fn.thooClock.setAlarm=function(e){var o;if(e instanceof Date)o=e;else{var a=e.split(":");o=new Date;for(var r=0;r<3;r++)a[r]=Math.floor(a[r]),(a[r]!=a[r]||a[r]>59)&&(a[r]=0),0==r&&a[r]>23&&(a[r]=0);o.setHours(a[0],a[1],a[2])}t.alarmTime=o},e.fn.thooClock.clearAlarm=function(){t.alarmTime=void 0,f(0,0),e(t).trigger("offAlarm")},void 0!==t.onAlarm&&e(t).on("onAlarm",function(e){t.onAlarm(),e.preventDefault(),e.stopPropagation()}),void 0!==t.onEverySecond&&e(t).on("onEverySecond",function(e){t.onEverySecond(),e.preventDefault()}),void 0!==t.offAlarm&&e(t).on("offAlarm",function(e){t.offAlarm(),e.stopPropagation(),e.preventDefault()}),f(0,0)})}}(jQuery);